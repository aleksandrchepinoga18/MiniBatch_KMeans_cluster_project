# MiniBatch_KMeans_cluster_project

# Проект: Сжатие изображений с использованием K-means и MiniBatchKMeans

## Описание
Этот проект демонстрирует применение алгоритмов кластеризации для сжатия изображений. Основная цель — уменьшить количество цветов в изображении с помощью методов K-means и MiniBatchKMeans, что позволяет упростить изображение, сохраняя его визуальную структуру.

---

## Используемые библиотеки
- **`numpy`**: Для работы с массивами и математических операций. Например, для нормализации данных и преобразования изображения в массив пикселей.
- **`matplotlib.pyplot`**: Для визуализации изображений и графиков. Используется для отображения исходного и сжатого изображений, а также для построения графиков распределения цветов.
- **`cv2` (OpenCV)**: Для загрузки и обработки изображений. OpenCV позволяет работать с изображениями в формате RGB и преобразовывать их в массивы пикселей.
- **`sklearn.cluster`**: Для реализации алгоритмов кластеризации (KMeans и MiniBatchKMeans). Эти алгоритмы группируют пиксели изображения в заданное количество кластеров (в данном случае 16).

---

## Методы и алгоритмы
- **K-means**: Алгоритм кластеризации, который группирует пиксели изображения в заданное количество кластеров (в данном случае 16). Каждый кластер представляет собой один цвет (центроид), который заменяет все пиксели в этом кластере. Это позволяет уменьшить количество цветов в изображении.
- **MiniBatchKMeans**: Ускоренная версия K-means, которая работает с поднаборами данных (батчами). Это позволяет ускорить процесс кластеризации, особенно для больших изображений, сохраняя при этом качество результата.
- **Нормализация данных**: Значения интенсивности пикселей нормализуются в диапазон [0, 1] для удобства обработки. Это важно для корректной работы алгоритмов кластеризации.
- **Визуализация**: Построение графиков распределения цветов в пространстве RGB и сравнение исходного изображения с изображением, сжатым до 16 цветов. Это помогает наглядно оценить результаты работы алгоритмов.

---

## Краткое описание проекта
1. **Загрузка изображения**:
   - Изображение загружается с помощью OpenCV и преобразуется в массив пикселей. Каждый пиксель представлен тремя значениями: Red, Green и Blue (RGB).

2. **Нормализация данных**:
   - Значения интенсивности пикселей нормализуются в диапазон [0, 1] путём деления на 255. Это необходимо для корректной работы алгоритмов кластеризации.

3. **Кластеризация**:
   - Применяется алгоритм K-means для группировки пикселей в 16 кластеров. Каждый пиксель заменяется на цвет центроида его кластера.
   - Для ускорения процесса используется MiniBatchKMeans, который работает с поднаборами данных (батчами).

4. **Визуализация**:
   - Строятся графики распределения цветов в пространстве RGB. Это позволяет увидеть, как цвета изображения распределены в пространстве Red-Green и Red-Blue.
   - Отображаются исходное изображение и изображение, сжатое до 16 цветов. Это помогает наглядно оценить качество сжатия.

5. **Анализ результатов**:
   - Проверяется количество уникальных цветов до и после кластеризации. Это позволяет убедиться, что изображение действительно сжато до 16 цветов.
   - Сравниваются результаты K-means и MiniBatchKMeans. MiniBatchKMeans показал схожие результаты с K-means, но работает быстрее.

---

## Итоги
- **Уменьшение количества цветов**: Изображение успешно сжато до 16 цветов с сохранением основных визуальных характеристик. Это позволяет упростить изображение, сохраняя его визуальную структуру.
- **Сравнение алгоритмов**: MiniBatchKMeans показал схожие результаты с K-means, но работает быстрее. Это делает его более предпочтительным для больших изображений.
- **Визуализация**: Графики распределения цветов и сравнение изображений наглядно демонстрируют эффективность метода. Это помогает лучше понять, как работает кластеризация.

---

## Примеры кода
```python
from sklearn.cluster import KMeans
import numpy as np
import matplotlib.pyplot as plt

# Загрузка изображения
img = plt.imread('path_to_image.jpg')

# Преобразуем изображение в массив пикселей
h, w, c = img.shape
pixels = img.reshape(-1, 3)

# Применяем KMeans для уменьшения количества цветов до 16
kmeans = KMeans(n_clusters=16)
kmeans.fit(pixels)
colors = kmeans.cluster_centers_  # Центры кластеров (16 цветов)
labels = kmeans.labels_  # Метки кластеров для каждого пикселя

# Перекрашиваем изображение
img_recolored = colors[labels].reshape(img.shape)

# Визуализация
fig, ax = plt.subplots(1, 2, figsize=(16, 6), subplot_kw=dict(xticks=[], yticks=[]))
fig.subplots_adjust(wspace=0.05)
ax[0].imshow(img)
ax[0].set_title('Исходное изображение', size=16)
ax[1].imshow(img_recolored)
ax[1].set_title('Изображение в 16 цветах', size=16)

plt.show()

Этот проект распространяется под лицензией MIT.
